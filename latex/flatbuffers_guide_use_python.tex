\chapter{Use in Python}
\hypertarget{flatbuffers_guide_use_python}{}\label{flatbuffers_guide_use_python}\index{Use in Python@{Use in Python}}
\doxysection*{Before you get started}

Before diving into the Flat\+Buffers usage in Python, it should be noted that the \doxysectlink{flatbuffers_guide_tutorial}{Tutorial}{0} page has a complete guide to general Flat\+Buffers usage in all of the supported languages (including Python). This page is designed to cover the nuances of Flat\+Buffers usage, specific to Python.

You should also have read the \doxysectlink{flatbuffers_guide_building}{Building}{0} documentation to build {\ttfamily flatc} and should be familiar with \doxysectlink{flatbuffers_guide_using_schema_compiler}{Using the schema compiler}{0} and \doxysectlink{flatbuffers_guide_writing_schema}{Writing a schema}{0}.

\doxysection*{Flat\+Buffers Python library code location}

The code for the Flat\+Buffers Python library can be found at {\ttfamily flatbuffers/python/flatbuffers}. You can browse the library code on the \href{https://github.com/google/flatbuffers/tree/master/
python}{\texttt{ Flat\+Buffers Git\+Hub page}}.

\doxysection*{Testing the Flat\+Buffers Python library}

The code to test the Python library can be found at {\ttfamily flatbuffers/tests}. The test code itself is located in \href{https://github.com/google/
flatbuffers/blob/master/tests/py_test.py}{\texttt{ py\+\_\+test.\+py}}.

To run the tests, use the \href{https://github.com/google/flatbuffers/
blob/master/tests/PythonTest.sh}{\texttt{ Python\+Test.\+sh}} shell script.

{\itshape Note\+: This script requires \href{https://www.python.org/}{\texttt{ python}} to be installed.}

\doxysection*{Using the Flat\+Buffers Python library}

{\itshape Note\+: See \doxysectlink{flatbuffers_guide_tutorial}{Tutorial}{0} for a more in-\/depth example of how to use Flat\+Buffers in Python.}

There is support for both reading and writing Flat\+Buffers in Python.

To use Flat\+Buffers in your own code, first generate Python classes from your schema with the {\ttfamily -\/-\/python} option to {\ttfamily flatc}. Then you can include both Flat\+Buffers and the generated code to read or write a Flat\+Buffer.

For example, here is how you would read a Flat\+Buffer binary file in Python\+: First, import the library and the generated code. Then read a Flat\+Buffer binary file into a {\ttfamily bytearray}, which you pass to the {\ttfamily Get\+Root\+As\+Monster} function\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keyword}{import}\ \mbox{\hyperlink{namespaceMyGame_1_1Example}{MyGame.Example}}\ \textcolor{keyword}{as}\ example}
\DoxyCodeLine{\textcolor{keyword}{import}\ flatbuffers}
\DoxyCodeLine{}
\DoxyCodeLine{buf\ =\ open(\textcolor{stringliteral}{'monster.dat'},\ \textcolor{stringliteral}{'rb'}).read()}
\DoxyCodeLine{buf\ =\ bytearray(buf)}
\DoxyCodeLine{monster\ =\ example.GetRootAsMonster(buf,\ 0)}

\end{DoxyCode}


Now you can access values like this\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{hp\ =\ monster.Hp()}
\DoxyCodeLine{pos\ =\ monster.Pos()}

\end{DoxyCode}


\doxysection*{Support for Numpy arrays}

The Flatbuffers python library also has support for accessing scalar vectors as numpy arrays. This can be orders of magnitude faster than iterating over the vector one element at a time, and is particularly useful when unpacking large nested flatbuffers. The generated code for a scalar vector will have a method {\ttfamily \texorpdfstring{$<$}{<}vector name\texorpdfstring{$>$}{>}As\+Numpy()}. In the case of the Monster example, you could access the inventory vector like this\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{inventory\ =\ monster.InventoryAsNumpy()}
\DoxyCodeLine{\textcolor{comment}{\#\ inventory\ is\ a\ numpy\ array\ of\ type\ np.dtype('uint8')}}

\end{DoxyCode}


instead of


\begin{DoxyCode}{0}
\DoxyCodeLine{inventory\ =\ []}
\DoxyCodeLine{\textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(monster.InventoryLength()):}
\DoxyCodeLine{\ \ \ \ inventory.append(int(monster.Inventory(i)))}

\end{DoxyCode}


Numpy is not a requirement. If numpy is not installed on your system, then attempting to access one of the {\ttfamily \texorpdfstring{$\ast$}{*}as\+Numpy()} methods will result in a {\ttfamily Numpy\+Required\+For\+This\+Feature} exception.

\doxysection*{Text Parsing}

There currently is no support for parsing text (Schema\textquotesingle{}s and JSON) directly from Python, though you could use the C++ parser through SWIG or ctypes. Please see the C++ documentation for more on text parsing.

~\newline
 