\chapter{Flatbuffers Intermediate Representation}
\hypertarget{intermediate_representation}{}\label{intermediate_representation}\index{Flatbuffers Intermediate Representation@{Flatbuffers Intermediate Representation}}
We use \href{https://github.com/google/flatbuffers/blob/master/reflection/reflection.fbs}{\texttt{ reflection.\+fbs}} as our intermediate representation. {\ttfamily flatc} parses {\ttfamily .fbs} files, checks them for errors and stores the resulting data in this IR, outputting {\ttfamily .bfbs} files. Since this IR is a Flatbuffer, you can load and use it at runtime for runtime reflection purposes.

There are some quirks\+:
\begin{DoxyItemize}
\item Tables and Structs are serialized as {\ttfamily Object}s.
\item Unions and Enums are serialized as {\ttfamily Enum}s.
\item It is the responsibility of the code generator to check the {\ttfamily advanced\+\_\+features} field of {\ttfamily Schema}. These mark the presence of new, backwards incompatible, schema features. Code generators must error if generating a schema with unrecognized advanced features.
\item Filenames are relative to a "{}project root"{} denoted by "{}//"{} in the path. This may be specified in flatc with {\ttfamily -\/-\/bfbs-\/filenames=\$PROJECT\+\_\+\+ROOT}, or it will be inferred to be the directory containing the first provided schema file.
\end{DoxyItemize}

\doxysection*{Invocation}

You can invoke it like so 
\begin{DoxyCode}{0}
\DoxyCodeLine{flatc\ -\/b\ -\/-\/schema\ \$\{your\_fbs\_files\}}

\end{DoxyCode}
 This generates {\ttfamily .bfbs} (binary flatbuffer schema) files.

Some information is not included by default. See the {\ttfamily -\/-\/bfbs-\/filenames} and {\ttfamily -\/-\/bfbs-\/comments} flags. These may be necessary for code-\/generators, so they can add documentation and maybe name generated files (depending on the generator).

TODO(cneo)\+: Flags to output bfbs as flexbuffers or json.

TODO(cneo)\+: Tutorial for building a flatc plugin. 