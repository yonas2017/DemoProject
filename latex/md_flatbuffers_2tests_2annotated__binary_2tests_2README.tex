\chapter{Tests for Annotated Binaries}
\hypertarget{md_flatbuffers_2tests_2annotated__binary_2tests_2README}{}\label{md_flatbuffers_2tests_2annotated__binary_2tests_2README}\index{Tests for Annotated Binaries@{Tests for Annotated Binaries}}
\doxysection*{Invalid Binary Tests}

The following is a collection of manually corrupted binaries based off of {\ttfamily ..\textbackslash{}annotated\+\_\+binary.\+bin}. Each file changes some offset or length/size entry to point so an invalid spot, and the generated annotated binaries demonstrate that those corruptions can be spotted.

Each of these files were ran with the following command\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{cd\ .tests/annotated\_binary}
\DoxyCodeLine{../../flatc\ -\/annotate\ annotated\_binary.fbs\ tests/\{binary\_file\}...}

\end{DoxyCode}


\doxysubsection*{{\ttfamily invalid\+\_\+root\+\_\+offset.\+bin}}

Changed first two bytes from {\ttfamily 4400} to {\ttfamily FFFF} which produces an offset larger than the binary.

\doxysubsection*{{\ttfamily invalid\+\_\+root\+\_\+table\+\_\+vtable\+\_\+offset.\+bin}}

Changed two bytes at 0x0044 from {\ttfamily 3A00} to {\ttfamily FFFF} which points to an offset outside the binary.

\doxysubsection*{{\ttfamily invalid\+\_\+root\+\_\+table\+\_\+too\+\_\+short.\+bin}}

Truncated the file to 0x46 bytes, as that cuts into the vtable offset field of the root table.


\begin{DoxyCode}{0}
\DoxyCodeLine{truncate\ annotated\_binary.bin\ -\/-\/size=70\ >>\ invalid\_root\_table\_too\_short.bin}

\end{DoxyCode}


\doxysubsection*{{\ttfamily invalid\+\_\+vtable\+\_\+size.\+bin}}

Changed two bytes at 0x000A from {\ttfamily 3A00} to {\ttfamily FFFF} which size is larger than the binary.

\doxysubsection*{{\ttfamily invalid\+\_\+vtable\+\_\+size\+\_\+short.\+bin}}

Changed two bytes at 0x000A from {\ttfamily 3A00} to {\ttfamily 0100} which size is smaller than the minimum size of 4 bytes.

\doxysubsection*{{\ttfamily invalid\+\_\+vtable\+\_\+ref\+\_\+table\+\_\+size.\+bin}}

Changed two bytes at 0x000C from {\ttfamily 6800} to {\ttfamily FFFF} which size is larger than the binary.

\doxysubsection*{{\ttfamily invalid\+\_\+vtable\+\_\+ref\+\_\+table\+\_\+size\+\_\+short.\+bin}}

Changed two bytes at 0x000C from {\ttfamily 6800} to {\ttfamily 0100} which size is smaller than the minimum size of 4 bytes.

\doxysubsection*{{\ttfamily invalid\+\_\+vtable\+\_\+field\+\_\+offset.\+bin}}

Changed two bytes at 0x0016 from {\ttfamily 1000} to {\ttfamily FFFF} which points to a field larger than the binary.

\doxysubsection*{{\ttfamily invalid\+\_\+table\+\_\+field\+\_\+size.\+bin}}

Truncated the file to 0x52 bytes, as that cuts a Uint32t value in half.

\doxysubsection*{{\ttfamily invalid\+\_\+table\+\_\+field\+\_\+offset.\+bin}}

Truncated the file to 0x96 bytes, as that cuts a UOffset32 value in half. Also, changed two bytes at 0x90 from {\ttfamily DC00} to {\ttfamily FFFF} which points to a section larger than the binary.

\doxysubsection*{{\ttfamily invalid\+\_\+string\+\_\+length\+\_\+cut\+\_\+short.\+bin}}

Truncated the file to 0x\+AD bytes, as that cuts string length Uint32t value in half.

\doxysubsection*{{\ttfamily invalid\+\_\+string\+\_\+length.\+bin}}

Changed two bytes at 0x00\+AC from {\ttfamily 0500} to {\ttfamily FFFF} which is a string length larger than the binary.

\doxysubsection*{{\ttfamily invalid\+\_\+vector\+\_\+length\+\_\+cut\+\_\+short.\+bin}}

Truncated the file to 0x0136 bytes, as that cuts vector length Uint32t value in half.

\doxysubsection*{{\ttfamily invalid\+\_\+struct\+\_\+field\+\_\+cut\+\_\+short.\+bin}}

Truncated the file to 0x5d bytes, as that cuts struct field value in half.

\doxysubsection*{{\ttfamily invalid\+\_\+struct\+\_\+array\+\_\+field\+\_\+cut\+\_\+short.\+bin}}

Truncated the file to 0x6A bytes, as that cuts struct array field value in half.

\doxysubsection*{{\ttfamily invalid\+\_\+vector\+\_\+structs\+\_\+cut\+\_\+short.\+bin}}

Truncated the file to 0x0154 bytes, as that cuts into a vector of structs.

\doxysubsection*{{\ttfamily invalid\+\_\+vector\+\_\+tables\+\_\+cut\+\_\+short.\+bin}}

Truncated the file to 0x01\+DE bytes, as that cuts into a vector of table offsets.

\doxysubsection*{{\ttfamily invalid\+\_\+vector\+\_\+strings\+\_\+cut\+\_\+short.\+bin}}

Truncated the file to 0x0176 bytes, as that cuts into a vector of string offsets.

\doxysubsection*{{\ttfamily invalid\+\_\+vector\+\_\+scalars\+\_\+cut\+\_\+short.\+bin}}

Truncated the file to 0x01\+C1 bytes, as that cuts into a vector of scalars values.

\doxysubsection*{{\ttfamily invalid\+\_\+vector\+\_\+unions\+\_\+cut\+\_\+short.\+bin}}

Truncated the file to 0x01\+DE bytes, as that cuts into a vector of union offset values.

\doxysubsection*{{\ttfamily invalid\+\_\+union\+\_\+type\+\_\+value.\+bin}}

Changed one byte at 0x004D from {\ttfamily 02} to {\ttfamily FF} which is a union type value that is larger than the enum.

\doxysubsection*{{\ttfamily invalid\+\_\+vector\+\_\+union\+\_\+type\+\_\+value.\+bin}}

Changed one byte at 0x0131 from {\ttfamily 02} to {\ttfamily FF} which is a vector union type value that is larger than the enum. 