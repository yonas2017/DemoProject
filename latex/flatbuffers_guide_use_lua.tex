\chapter{Use in Lua}
\hypertarget{flatbuffers_guide_use_lua}{}\label{flatbuffers_guide_use_lua}\index{Use in Lua@{Use in Lua}}
\doxysection*{Before you get started}

Before diving into the Flat\+Buffers usage in Lua, it should be noted that the \doxysectlink{flatbuffers_guide_tutorial}{Tutorial}{0} page has a complete guide to general Flat\+Buffers usage in all of the supported languages (including Lua). This page is designed to cover the nuances of Flat\+Buffers usage, specific to Lua.

You should also have read the \doxysectlink{flatbuffers_guide_building}{Building}{0} documentation to build {\ttfamily flatc} and should be familiar with \doxysectlink{flatbuffers_guide_using_schema_compiler}{Using the schema compiler}{0} and \doxysectlink{flatbuffers_guide_writing_schema}{Writing a schema}{0}.

\doxysection*{Flat\+Buffers Lua library code location}

The code for the Flat\+Buffers Lua library can be found at {\ttfamily flatbuffers/lua}. You can browse the library code on the \href{https://github.com/google/flatbuffers/tree/master/lua}{\texttt{ Flat\+Buffers Git\+Hub page}}.

\doxysection*{Testing the Flat\+Buffers Lua library}

The code to test the Lua library can be found at {\ttfamily flatbuffers/tests}. The test code itself is located in \href{https://github.com/google/
flatbuffers/blob/master/tests/luatest.lua}{\texttt{ luatest.\+lua}}.

To run the tests, use the \href{https://github.com/google/flatbuffers/
blob/master/tests/LuaTest.sh}{\texttt{ Lua\+Test.\+sh}} shell script.

{\itshape Note\+: This script requires \href{https://www.lua.org/}{\texttt{ Lua 5.\+3}} and \href{http://luajit.org/}{\texttt{ Lua\+JIT}} to be installed.}

\doxysection*{Using the Flat\+Buffers Lua library}

{\itshape Note\+: See \doxysectlink{flatbuffers_guide_tutorial}{Tutorial}{0} for a more in-\/depth example of how to use Flat\+Buffers in Lua.}

There is support for both reading and writing Flat\+Buffers in Lua.

To use Flat\+Buffers in your own code, first generate Lua classes from your schema with the {\ttfamily -\/-\/lua} option to {\ttfamily flatc}. Then you can include both Flat\+Buffers and the generated code to read or write a Flat\+Buffer.

For example, here is how you would read a Flat\+Buffer binary file in Lua\+: First, require the module and the generated code. Then read a Flat\+Buffer binary file into a {\ttfamily string}, which you pass to the {\ttfamily Get\+Root\+As\+Monster} function\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{-\/-\/\ require\ the\ library}
\DoxyCodeLine{local\ flatbuffers\ =\ require("{}flatbuffers"{})}
\DoxyCodeLine{}
\DoxyCodeLine{-\/-\/\ require\ the\ generated\ code}
\DoxyCodeLine{local\ monster\ =\ require("{}MyGame.Sample.Monster"{})}
\DoxyCodeLine{}
\DoxyCodeLine{-\/-\/\ read\ the\ flatbuffer\ from\ a\ file\ into\ a\ string}
\DoxyCodeLine{local\ f\ =\ io.open('monster.dat',\ 'rb')}
\DoxyCodeLine{local\ buf\ =\ f:read('*a')}
\DoxyCodeLine{f:close()}
\DoxyCodeLine{}
\DoxyCodeLine{-\/-\/\ parse\ the\ flatbuffer\ to\ get\ an\ instance\ to\ the\ root\ monster}
\DoxyCodeLine{local\ monster1\ =\ monster.GetRootAsMonster(buf,\ 0)}

\end{DoxyCode}


Now you can access values like this\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{-\/-\/\ use\ the\ :\ notation\ to\ access\ member\ data}
\DoxyCodeLine{local\ hp\ =\ monster1:Hp()}
\DoxyCodeLine{local\ pos\ =\ monster1:Pos()}

\end{DoxyCode}


\doxysection*{Text Parsing}

There currently is no support for parsing text (Schema\textquotesingle{}s and JSON) directly from Lua, though you could use the C++ parser through SWIG or ctypes. Please see the C++ documentation for more on text parsing.

~\newline
 