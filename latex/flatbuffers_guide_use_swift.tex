\chapter{Use in Swift}
\hypertarget{flatbuffers_guide_use_swift}{}\label{flatbuffers_guide_use_swift}\index{Use in Swift@{Use in Swift}}
\doxysection*{Before you get started}

Before diving into the Flat\+Buffers usage in Swift, it should be noted that the \doxysectlink{flatbuffers_guide_tutorial}{Tutorial}{0} page has a complete guide to general Flat\+Buffers usage in all of the supported languages (including Swift). This page is designed to cover the nuances of Flat\+Buffers usage, specific to Swift.

You should also have read the \doxysectlink{flatbuffers_guide_building}{Building}{0} documentation to build {\ttfamily flatc} and should be familiar with \doxysectlink{flatbuffers_guide_using_schema_compiler}{Using the schema compiler}{0} and \doxysectlink{flatbuffers_guide_writing_schema}{Writing a schema}{0}.

\doxysection*{Flat\+Buffers Swift library code location}

The code for the Flat\+Buffers Swift library can be found at {\ttfamily flatbuffers/swift}. You can browse the library code on the \href{https://github.com/google/flatbuffers/tree/master/swift}{\texttt{ Flat\+Buffers Git\+Hub page}}.

\doxysection*{Testing the Flat\+Buffers Swift library}

The code to test the Swift library can be found at {\ttfamily flatbuffers/tests/swift/tests}. The test code itself is located in \href{https://github.com/google/flatbuffers/blob/master/tests/swift/tests}{\texttt{ flatbuffers/tests/swift/tests}}.

To run the tests, use the \href{https://github.com/google/flatbuffers/blob/master/tests/swift/tests/SwiftTest.sh}{\texttt{ Swift\+Test.\+sh}} shell script.

{\itshape Note\+: The shell script requires \href{https://swift.org}{\texttt{ Swift}} to be installed.}

\doxysection*{Using the Flat\+Buffers Swift library}

{\itshape Note\+: See \doxysectlink{flatbuffers_guide_tutorial}{Tutorial}{0} for a more in-\/depth example of how to use Flat\+Buffers in Swift.}

Flat\+Buffers supports reading and writing binary Flat\+Buffers in Swift.

To use Flat\+Buffers in your own code, first generate Swift structs from your schema with the {\ttfamily -\/-\/swift} option to {\ttfamily flatc}. Then include Flat\+Buffers using {\ttfamily SPM} in by adding the path to {\ttfamily Flat\+Buffers/swift} into it. The generated code should also be added to xcode or the path of the package you will be using. Note\+: sometimes xcode cant and wont see the generated files, so it\textquotesingle{}s better that you copy them to xcode.

For example, here is how you would read a Flat\+Buffer binary file in Swift\+: First, include the library and copy thegenerated code. Then read a Flat\+Buffer binary file or a data object from the server, which you can pass into the {\ttfamily Get\+Root\+As\+Monster} function.


\begin{DoxyCode}{0}
\DoxyCodeLine{import\ FlatBuffers}
\DoxyCodeLine{}
\DoxyCodeLine{typealias\ Monster1\ =\ MyGame.Sample.Monster}
\DoxyCodeLine{typealias\ Vec3\ =\ MyGame.Sample.Vec3}
\DoxyCodeLine{}
\DoxyCodeLine{let\ path\ =\ FileManager.default.currentDirectoryPath}
\DoxyCodeLine{let\ url\ =\ URL(fileURLWithPath:\ path,\ isDirectory:\ true).appendingPathComponent("{}monsterdata\_test"{}).appendingPathExtension("{}mon"{})}
\DoxyCodeLine{guard\ let\ data\ =\ try?\ Data(contentsOf:\ url)\ else\ \{\ return\ \}}
\DoxyCodeLine{}
\DoxyCodeLine{let\ monster\ =\ Monster.getRootAsMonster(bb:\ ByteBuffer(data:\ data))}

\end{DoxyCode}


Now you can access values like this\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{let\ hp\ =\ monster.hp}
\DoxyCodeLine{let\ pos\ =\ monster.pos\ //\ uses\ native\ swift\ structs}
\DoxyCodeLine{let\ pos\ =\ monster.mutablePos\ //\ uses\ flatbuffers\ structs}

\end{DoxyCode}


In some cases it\textquotesingle{}s necessary to modify values in an existing Flat\+Buffer in place (without creating a copy). For this reason, scalar fields of a Flatbuffer table or struct can be mutated.


\begin{DoxyCode}{0}
\DoxyCodeLine{var\ byteBuffer\ =\ ByteBuffer(bytes:\ data)}
\DoxyCodeLine{//\ Get\ an\ accessor\ to\ the\ root\ object\ inside\ the\ buffer.}
\DoxyCodeLine{let\ monster:\ Monster\ =\ try!\ getCheckedRoot(byteBuffer:\ \&byteBuffer)}
\DoxyCodeLine{//\ let\ monster:\ Monster\ =\ getRoot(byteBuffer:\ \&byteBuffer)}
\DoxyCodeLine{}
\DoxyCodeLine{if\ !monster.mutate(hp:\ 10)\ \{}
\DoxyCodeLine{\ \ fatalError("{}couldn't\ mutate"{})}
\DoxyCodeLine{\}}
\DoxyCodeLine{//\ mutate\ a\ struct\ field\ using\ flatbuffers\ struct}
\DoxyCodeLine{//\ DONT\ use\ monster.pos\ to\ mutate\ since\ swift\ copy\ on\ write\ }
\DoxyCodeLine{//\ will\ not\ mutate\ the\ value\ in\ the\ buffer}
\DoxyCodeLine{let\ vec\ =\ monster.mutablePos.mutate(z:\ 4)}
\DoxyCodeLine{}
\DoxyCodeLine{//\ This\ mutation\ will\ fail\ because\ the\ mana\ field\ is\ not\ available\ in}
\DoxyCodeLine{//\ the\ buffer.\ It\ should\ be\ set\ when\ creating\ the\ buffer.}
\DoxyCodeLine{if\ !monster.mutate(mana:\ 20)\ \{}
\DoxyCodeLine{\ \ fatalError("{}couldn't\ mutate"{})}
\DoxyCodeLine{\}}

\end{DoxyCode}


The term {\ttfamily mutate} is used instead of {\ttfamily set} to indicate that this is a special use case. All mutate functions return a boolean value which is false if the field we\textquotesingle{}re trying to mutate is not available in the buffer.

~\newline
 